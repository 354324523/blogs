import{l as U,i as Z,m as ee,p as M,q as se,s as te,v as ae,x as le,j as q,y as S,z as Ee,A as j,k as t,B as $,C as _,R as I,D as re,E as ue,G as ie,H as oe,I as ne,J as Ae,K as ce,L as Be,O as de,M as ve,N as he,P as ye,Q as pe,S as me,T}from"./app-DWz5k_-z.js";const Fe=["/","/demo/","/demo/disable.html","/demo/layout.html","/demo/markdown.html","/demo/page.html","/guide/","/python/","/mysql/","/redis/","/guide/bar/","/guide/bar/baz.html","/guide/foo/","/guide/foo/ray.html","/redis/%E5%BA%94%E7%94%A8%E7%AF%87/","/redis/%E5%BA%94%E7%94%A8%E7%AF%87/Redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81.html","/redis/%E5%BA%94%E7%94%A8%E7%AF%87/%E5%B8%83%E9%9A%86%E8%BF%87%E6%BB%A4%E5%99%A8%E4%B8%8E%E5%B8%83%E8%B0%B7%E9%B8%9F%E8%BF%87%E6%BB%A4%E5%99%A8.html","/redis/%E6%8C%81%E4%B9%85%E5%8C%96%E7%AF%87/AOF%E6%8C%81%E4%B9%85%E5%8C%96.html","/redis/%E6%8C%81%E4%B9%85%E5%8C%96%E7%AF%87/RDB%E6%8C%81%E4%B9%85%E5%8C%96.html","/redis/%E6%8C%81%E4%B9%85%E5%8C%96%E7%AF%87/","/redis/%E6%8C%81%E4%B9%85%E5%8C%96%E7%AF%87/%E5%A4%A7Key%E5%AF%B9%E6%8C%81%E4%B9%85%E5%8C%96%E7%9A%84%E5%BD%B1%E5%93%8D.html","/redis/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AF%87/","/redis/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AF%87/Redis%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%8F%8A%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF.html","/redis/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AF%87/Redis%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84.html","/redis/%E7%AD%96%E7%95%A5%E7%AF%87/","/redis/%E7%AD%96%E7%95%A5%E7%AF%87/%E5%86%85%E5%AD%98%E6%B7%98%E6%B1%B0%E7%AD%96%E7%95%A5.html","/redis/%E7%AD%96%E7%95%A5%E7%AF%87/%E8%BF%87%E6%9C%9F%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5.html","/redis/%E7%BC%93%E5%AD%98%E7%AF%87/","/redis/%E7%BC%93%E5%AD%98%E7%AF%87/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E7%BC%93%E5%AD%98%E4%B8%80%E8%87%B4%E6%80%A7.html","/redis/%E7%BC%93%E5%AD%98%E7%AF%87/%E7%BC%93%E5%AD%98%E7%B1%BB%E5%9E%8B%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F%E7%BB%8F%E5%85%B8%E7%9A%84%E7%BC%93%E5%AD%98%E7%AD%96%E7%95%A5%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F.html","/redis/%E7%BC%93%E5%AD%98%E7%AF%87/%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E4%B8%8E%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F.html","/redis/%E9%9D%A2%E8%AF%95%E7%AF%87/","/redis/%E9%9D%A2%E8%AF%95%E7%AF%87/Redis%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98.html","/redis/%E9%9D%A2%E8%AF%95%E7%AF%87/Redis%E7%BC%93%E5%86%B2%E5%8C%BA.html","/redis/%E9%AB%98%E5%8F%AF%E7%94%A8%E7%AF%87/","/redis/%E9%AB%98%E5%8F%AF%E7%94%A8%E7%AF%87/%E4%B8%BB%E4%BB%8E%E6%A8%A1%E5%BC%8F.html","/redis/%E9%AB%98%E5%8F%AF%E7%94%A8%E7%AF%87/%E5%93%A8%E5%85%B5%E6%A8%A1%E5%BC%8F.html","/redis/%E9%AB%98%E5%8F%AF%E7%94%A8%E7%AF%87/%E9%9B%86%E7%BE%A4%E6%A8%A1%E5%BC%8F.html","/404.html","/category/","/category/%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/","/category/%E6%8C%87%E5%8D%97/","/category/python/","/category/mysql/","/category/redis/","/tag/","/tag/%E7%A6%81%E7%94%A8/","/tag/%E5%8A%A0%E5%AF%86/","/tag/%E5%B8%83%E5%B1%80/","/tag/markdown/","/tag/%E9%A1%B5%E9%9D%A2%E9%85%8D%E7%BD%AE/","/tag/%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/","/tag/%E5%9F%BA%E7%A1%80/","/article/","/star/","/timeline/"],Ce="SEARCH_PRO_QUERY_HISTORY",d=U(Ce,[]),ge=()=>{const{queryHistoryCount:a}=T,l=a>0;return{enabled:l,queryHistory:d,addQueryHistory:E=>{l&&(d.value.length<a?d.value=Array.from(new Set([E,...d.value])):d.value=Array.from(new Set([E,...d.value.slice(0,a-1)])))},removeQueryHistory:E=>{d.value=[...d.value.slice(0,E),...d.value.slice(E+1)]}}},L=a=>Fe[a.id]+("anchor"in a?`#${a.anchor}`:""),De="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:b}=T,v=U(De,[]),fe=()=>{const a=b>0;return{enabled:a,resultHistory:v,addResultHistory:l=>{if(a){const E={link:L(l),display:l.display};"header"in l&&(E.header=l.header),v.value.length<b?v.value=[E,...v.value]:v.value=[E,...v.value.slice(0,b-1)]}},removeResultHistory:l=>{v.value=[...v.value.slice(0,l),...v.value.slice(l+1)]}}},Re=a=>{const l=ne(),E=M(),H=Ae(),u=q(!1),y=ce([]);return Be(()=>{const{search:C,terminate:h}=de(),g=()=>{y.value=[],u.value=!1},p=me(c=>{u.value=!0,c?C(c,E.value,l.value).then(B=>{var D,m;return((m=(D=l.value).searchFilter)==null?void 0:m.call(D,B,c,E.value,H.value))??B}).then(B=>{y.value=B,u.value=!1}).catch(B=>{console.error(B),g()}):g()},T.searchDelay);j([a,E],()=>p(a.value),{immediate:!0}),ve(()=>{h()})}),{searching:u,results:y}};var ke=Z({name:"SearchResult",props:{query:{type:String,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:l}){const E=ee(),H=M(),u=se(te),{enabled:y,addQueryHistory:C,queryHistory:h,removeQueryHistory:g}=ge(),{enabled:p,resultHistory:c,addResultHistory:B,removeResultHistory:D}=fe(),m=y||p,k=ae(a,"query"),{results:F,searching:z}=Re(k),r=le({isQuery:!0,index:0}),n=q(0),A=q(0),O=S(()=>m&&(h.value.length>0||c.value.length>0)),Q=S(()=>F.value.length>0),w=S(()=>F.value[n.value]||null),K=()=>{const{isQuery:e,index:s}=r;s===0?(r.isQuery=!e,r.index=e?c.value.length-1:h.value.length-1):r.index=s-1},Y=()=>{const{isQuery:e,index:s}=r;s===(e?h.value.length-1:c.value.length-1)?(r.isQuery=!e,r.index=0):r.index=s+1},G=()=>{n.value=n.value>0?n.value-1:F.value.length-1,A.value=w.value.contents.length-1},J=()=>{n.value=n.value<F.value.length-1?n.value+1:0,A.value=0},N=()=>{A.value<w.value.contents.length-1?A.value+=1:J()},V=()=>{A.value>0?A.value-=1:G()},x=e=>e.map(s=>he(s)?s:t(s[0],s[1])),W=e=>{if(e.type==="customField"){const s=ye[e.index]||"$content",[i,R=""]=pe(s)?s[H.value].split("$content"):s.split("$content");return e.display.map(o=>t("div",x([i,...o,R])))}return e.display.map(s=>t("div",x(s)))},f=()=>{n.value=0,A.value=0,l("updateQuery",""),l("close")};return Ee("keydown",e=>{if(a.isFocusing){if(Q.value){if(e.key==="ArrowUp")V();else if(e.key==="ArrowDown")N();else if(e.key==="Enter"){const s=w.value.contents[A.value];C(a.query),B(s),E.push(L(s)),f()}}else if(p){if(e.key==="ArrowUp")K();else if(e.key==="ArrowDown")Y();else if(e.key==="Enter"){const{index:s}=r;r.isQuery?(l("updateQuery",h.value[s]),e.preventDefault()):(E.push(c.value[s].link),f())}}}}),j([n,A],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["search-pro-result-wrapper",{empty:k.value?!Q.value:!O.value}],id:"search-pro-results"},k.value===""?m?O.value?[y?t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},u.value.queryHistory),h.value.map((e,s)=>t("div",{class:["search-pro-result-item",{active:r.isQuery&&r.index===s}],onClick:()=>{l("updateQuery",e)}},[t($,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},e),t("button",{class:"search-pro-remove-icon",innerHTML:_,onClick:i=>{i.preventDefault(),i.stopPropagation(),g(s)}})]))])):null,p?t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},u.value.resultHistory),c.value.map((e,s)=>t(I,{to:e.link,class:["search-pro-result-item",{active:!r.isQuery&&r.index===s}],onClick:()=>{f()}},()=>[t($,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(i=>x(i)).flat())]),t("button",{class:"search-pro-remove-icon",innerHTML:_,onClick:i=>{i.preventDefault(),i.stopPropagation(),D(s)}})]))])):null]:u.value.emptyHistory:u.value.emptyResult:z.value?t(re,{hint:u.value.searching}):Q.value?t("ul",{class:"search-pro-result-list"},F.value.map(({title:e,contents:s},i)=>{const R=n.value===i;return t("li",{class:["search-pro-result-list-item",{active:R}]},[t("div",{class:"search-pro-result-title"},e||u.value.defaultTitle),s.map((o,X)=>{const P=R&&A.value===X;return t(I,{to:L(o),class:["search-pro-result-item",{active:P,"aria-selected":P}],onClick:()=>{C(a.query),B(o),f()}},()=>[o.type==="text"?null:t(o.type==="title"?ue:o.type==="heading"?ie:oe,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[o.type==="text"&&o.header?t("div",{class:"content-header"},o.header):null,t("div",W(o))])])})])})):u.value.emptyResult)}});export{ke as default};
