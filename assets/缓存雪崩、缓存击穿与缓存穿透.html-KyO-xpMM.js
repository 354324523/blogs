import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as s,o as p,c as h,d as e,f as t,b as n,w as o,e as i}from"./app-DWz5k_-z.js";const c={},d=i('<p>在Redis使用过程中，可能会遇到各种问题。以下是一些常见问题及解决方案：</p><h2 id="缓存雪崩" tabindex="-1"><a class="header-anchor" href="#缓存雪崩"><span>缓存雪崩</span></a></h2><p>问题描述：指缓存中<strong>大量数据在同一时间突然失效或者突然不可用时</strong>，大量的请求直接打到后端数据库，导致数据库压力剧增，甚至崩溃的现象。</p><h3 id="雪崩常见原因" tabindex="-1"><a class="header-anchor" href="#雪崩常见原因"><span>雪崩常见原因</span></a></h3><ul><li><strong>大量热点数据失效</strong>：热门数据在缓存中失效，会导致大量请求直接打到数据库，数据库压力骤增。</li><li><strong>缓存集中过期</strong>：如果大量缓存数据设置了相同或接近的过期时间，当这些缓存同时过期时，大量请求会同时打到后端数据库。</li><li><strong>缓存服务器宕机</strong>：当缓存服务器宕机或不可用时，所有请求都会直接打到后端数据库。</li></ul><h3 id="解决方案" tabindex="-1"><a class="header-anchor" href="#解决方案"><span>解决方案</span></a></h3><ul><li><p><strong>热点数据用不过期</strong>：对一些非常热点的数据，设置永不过期，并在后台定时刷新这些数据。</p></li><li><p><strong>随机化过期时间</strong>：设置缓存数据的过期时间时，加入一定的随机性，避免大量缓存数据在同一时间过期。</p></li><li><p><strong>搭建高可用集群</strong>：部署 Redis 高可用架构，如主从复制、哨兵（Sentinel）、集群模式等，以确保即使部分节点宕机，整个系统依然可用。</p></li><li><p><strong>缓存预热</strong>：在系统启动时或低峰期，可以通过缓存预热的方式将热点数据提前加载到缓存中，减少在高峰期对数据库的请求压力。</p></li><li><p><strong>互斥锁</strong>：在缓存失效时，通过加锁机制来控制只有一个线程去加载数据和更新缓存，其他线程等待锁释放后再访问缓存。</p></li><li><p><strong>限流降级</strong>：在缓存失效的情况下，使用限流机制保护数据库，或者降级处理，返回默认值或提示用户稍后重试。</p></li></ul><h2 id="缓存击穿" tabindex="-1"><a class="header-anchor" href="#缓存击穿"><span>缓存击穿</span></a></h2><p>问题描述：缓存中的<strong>某个热点数据在失效的瞬间，有大量请求并发访问该数据</strong>，直接打到了后端数据库，造成数据库压力骤增。</p><h3 id="击穿常见原因" tabindex="-1"><a class="header-anchor" href="#击穿常见原因"><span>击穿常见原因：</span></a></h3><ul><li><strong>某个热点数据失效</strong>：某个热点数据的访问频率非常高，如果这个数据突然失效，可能会引起大量请求同时访问该数据，导致缓存击穿。</li></ul><h3 id="解决方案-1" tabindex="-1"><a class="header-anchor" href="#解决方案-1"><span>解决方案：</span></a></h3><p>可以发现缓存击穿跟缓存雪崩很相似，你可以认为缓存击穿是缓存雪崩的一个子集。应对缓存击穿可采取前面说到的两种方案</p>',13),g=e("li",null,[e("strong",null,"热点数据用不过期"),t("：对一些非常热点的数据，设置永不过期，并在后台定时刷新这些数据。")],-1),u=e("strong",null,"互斥锁",-1),E=i('<h2 id="缓存穿透" tabindex="-1"><a class="header-anchor" href="#缓存穿透"><span>缓存穿透</span></a></h2><p>问题描述：<strong>查询的数据既不在缓存也不在数据库</strong>，导致请求在访问缓存时，发现缓存缺失，再去访问数据库时，发现数据库中也没有要访问的数据，没办法构建缓存数据来服务后续的请求。那么当有大量这样的请求到来时，造成数据库压力骤增。</p><h3 id="穿透常见原因" tabindex="-1"><a class="header-anchor" href="#穿透常见原因"><span>穿透常见原因：</span></a></h3><ul><li><strong>业务误操作</strong>：缓存中的数据和数据库中的数据都被误删除了，所以导致缓存和数据库中都没有数据。</li><li><strong>恶意攻击</strong>：被攻击，恶意访问某些不存在数据的业务，例如数据库的ID一般都是从1自增上去的，而用户不断访问ID为-1的数据或者ID特别大不存在的数据。</li></ul><h3 id="解决方案-2" tabindex="-1"><a class="header-anchor" href="#解决方案-2"><span>解决方案</span></a></h3>',5),_=e("li",null,[e("p",null,[e("strong",null,"参数校验"),t("：对请求的参数进行合理性校验，防止恶意请求进入系统。")])],-1),m=e("li",null,[e("p",null,[e("strong",null,"缓存空值"),t("：对于查询数据库后确认不存在的数据，将空结果（如null或特定的占位符）缓存起来，设置一个短暂的过期时间（时间过久可能会影响业务），以避免频繁查询同一个不存在的数据。")])],-1),B=e("li",null,[e("p",null,[e("strong",null,"限流"),t("：对IP进行限流，普通用户不会单秒内发起大量的请求。")])],-1),A=e("p",null,"参考链接：",-1),f={href:"https://archmanual.com/backend/redis/problem.html",target:"_blank",rel:"noopener noreferrer"},b={href:"https://xiaolincoding.com/redis/cluster/cache_problem.html",target:"_blank",rel:"noopener noreferrer"};function k(x,v){const l=s("RouteLink"),r=s("ExternalLinkIcon");return p(),h("div",null,[d,e("ul",null,[g,e("li",null,[u,t("：单机可设置互斥锁，分布式的话还得使用"),n(l,{to:"/redis/%E5%BA%94%E7%94%A8%E7%AF%87/Redis%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81.html"},{default:o(()=>[t("分布式锁")]),_:1}),t("。保证同一时间只有一个业务线程更新缓存，未能获取互斥锁的请求，要么等待锁释放后重新读取缓存，要么就返回空值或者默认值。")])]),E,e("ul",null,[_,m,B,e("li",null,[e("p",null,[e("strong",null,[n(l,{to:"/redis/%E5%BA%94%E7%94%A8%E7%AF%87/%E5%B8%83%E9%9A%86%E8%BF%87%E6%BB%A4%E5%99%A8%E4%B8%8E%E5%B8%83%E8%B0%B7%E9%B8%9F%E8%BF%87%E6%BB%A4%E5%99%A8.html"},{default:o(()=>[t("布隆过滤器")]),_:1})]),t("：使用布隆过滤器快速判断数据是否存在，避免通过查询数据库来判断数据是否存在；")])])]),A,e("blockquote",null,[e("p",null,[e("a",f,[t("雪崩、击穿"),n(r)])]),e("p",null,[e("a",b,[t("什么是缓存雪崩、击穿、穿透？ | 小林 coding"),n(r)])])])])}const C=a(c,[["render",k],["__file","缓存雪崩、缓存击穿与缓存穿透.html.vue"]]),D=JSON.parse('{"path":"/redis/%E7%BC%93%E5%AD%98%E7%AF%87/%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E4%B8%8E%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F.html","title":"缓存雪崩、缓存击穿与缓存穿透","lang":"zh-CN","frontmatter":{"title":"缓存雪崩、缓存击穿与缓存穿透","order":2,"category":["Redis"],"description":"在Redis使用过程中，可能会遇到各种问题。以下是一些常见问题及解决方案： 缓存雪崩 问题描述：指缓存中大量数据在同一时间突然失效或者突然不可用时，大量的请求直接打到后端数据库，导致数据库压力剧增，甚至崩溃的现象。 雪崩常见原因 大量热点数据失效：热门数据在缓存中失效，会导致大量请求直接打到数据库，数据库压力骤增。 缓存集中过期：如果大量缓存数据设置了...","head":[["meta",{"property":"og:url","content":"https://vuepress-theme-hope-docs-demo.netlify.app/blogs/redis/%E7%BC%93%E5%AD%98%E7%AF%87/%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9%E3%80%81%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF%E4%B8%8E%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F.html"}],["meta",{"property":"og:site_name","content":"皮卡丘"}],["meta",{"property":"og:title","content":"缓存雪崩、缓存击穿与缓存穿透"}],["meta",{"property":"og:description","content":"在Redis使用过程中，可能会遇到各种问题。以下是一些常见问题及解决方案： 缓存雪崩 问题描述：指缓存中大量数据在同一时间突然失效或者突然不可用时，大量的请求直接打到后端数据库，导致数据库压力剧增，甚至崩溃的现象。 雪崩常见原因 大量热点数据失效：热门数据在缓存中失效，会导致大量请求直接打到数据库，数据库压力骤增。 缓存集中过期：如果大量缓存数据设置了..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:author","content":"皮卡丘"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"缓存雪崩、缓存击穿与缓存穿透\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"皮卡丘\\",\\"url\\":\\"https://www.baidu.com\\"}]}"]]},"headers":[{"level":2,"title":"缓存雪崩","slug":"缓存雪崩","link":"#缓存雪崩","children":[{"level":3,"title":"雪崩常见原因","slug":"雪崩常见原因","link":"#雪崩常见原因","children":[]},{"level":3,"title":"解决方案","slug":"解决方案","link":"#解决方案","children":[]}]},{"level":2,"title":"缓存击穿","slug":"缓存击穿","link":"#缓存击穿","children":[{"level":3,"title":"击穿常见原因：","slug":"击穿常见原因","link":"#击穿常见原因","children":[]},{"level":3,"title":"解决方案：","slug":"解决方案-1","link":"#解决方案-1","children":[]}]},{"level":2,"title":"缓存穿透","slug":"缓存穿透","link":"#缓存穿透","children":[{"level":3,"title":"穿透常见原因：","slug":"穿透常见原因","link":"#穿透常见原因","children":[]},{"level":3,"title":"解决方案","slug":"解决方案-2","link":"#解决方案-2","children":[]}]}],"git":{"createdTime":null,"updatedTime":null,"contributors":[]},"readingTime":{"minutes":4.14,"words":1241},"filePathRelative":"redis/缓存篇/缓存雪崩、缓存击穿与缓存穿透.md","excerpt":"<p>在Redis使用过程中，可能会遇到各种问题。以下是一些常见问题及解决方案：</p>\\n<h2>缓存雪崩</h2>\\n<p>问题描述：指缓存中<strong>大量数据在同一时间突然失效或者突然不可用时</strong>，大量的请求直接打到后端数据库，导致数据库压力剧增，甚至崩溃的现象。</p>\\n<h3>雪崩常见原因</h3>\\n<ul>\\n<li><strong>大量热点数据失效</strong>：热门数据在缓存中失效，会导致大量请求直接打到数据库，数据库压力骤增。</li>\\n<li><strong>缓存集中过期</strong>：如果大量缓存数据设置了相同或接近的过期时间，当这些缓存同时过期时，大量请求会同时打到后端数据库。</li>\\n<li><strong>缓存服务器宕机</strong>：当缓存服务器宕机或不可用时，所有请求都会直接打到后端数据库。</li>\\n</ul>","autoDesc":true}');export{C as comp,D as data};
